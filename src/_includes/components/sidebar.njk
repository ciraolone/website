{#
  Componente Sidebar Sticky per Landing Page (Stile Neobrutalista)

  Su desktop: sidebar completa sticky a destra
  Su mobile: features in alto, CTA fixed in basso

  Parametri:
  - price: prezzo del prodotto (es. "499 â‚¬")
  - ctaText: testo del pulsante CTA (default: "Acquista subito!")
  - ctaUrl: URL del pulsante CTA (richiesto)
  - paymentNote: nota sul pagamento (es. "Puoi pagare in 3 rate.")
  - urgencyNote: nota di urgenza (opzionale, es. "Attenzione: le iscrizioni...")
  - tagline: testo in corsivo prima delle features (opzionale, es. "Questa Masterclass fa per te se...")
  - features: array di stringhe con le feature incluse
  - secondaryTitle: titolo sezione secondaria (opzionale)
  - secondarySubtitle: sottotitolo sezione secondaria (opzionale)
  - secondaryFeatures: array di feature secondarie (opzionale)

  Uso come macro:
  {% from "components/sidebar.njk" import sidebar, sidebarMobileFeatures, sidebarMobileCta %}

  Desktop: {{ sidebar(...) }}
  Mobile features (sopra contenuto): {{ sidebarMobileFeatures(...) }}
  Mobile CTA (fixed bottom): {{ sidebarMobileCta(...) }}
#}

{% from "components/button.njk" import button %}
{% from "components/alert.njk" import alert %}

{# === SIDEBAR DESKTOP (nascosta su mobile) === #}
{% macro sidebar(
  price,
  ctaText="Acquista subito!",
  ctaUrl,
  paymentNote="",
  urgencyNote="",
  tagline="",
  features=[],
  secondaryTitle="",
  secondarySubtitle="",
  secondaryFeatures=[]
) %}
<aside class="sticky top-8 border-2 border-black bg-white p-6 rounded-default hidden lg:block shadow">
  {# Prezzo #}
  <div class="text-center mb-4">
    <span class="text-6xl font-bold text-black">{{ price }}</span>
  </div>

  {# Pulsante CTA #}
  <div class="mb-2">
    {{ button(ctaText, ctaUrl, className="w-full text-center justify-center") }}
  </div>

  {# Nota pagamento #}
  {% if paymentNote %}
  <p class="text-center text-sm text-gray-600 mb-4">{{ paymentNote }}</p>
  {% endif %}

  {# Nota urgenza #}
  {% if urgencyNote %}
  <div class="mb-6">
    {{ alert("Attenzione: " + urgencyNote, variant="warning") }}
  </div>
  {% endif %}

  {# Tagline in corsivo #}
  {% if tagline %}
  <p class="text-sm text-gray-700 italic mb-4">{{ tagline }}</p>
  {% endif %}

  {# Sezione Features Incluse #}
  {% if features.length > 0 %}
  <div class="my-6">
    <h4 class="font-bold text-black mb-3 border-b-2 border-black pb-2">Incluso nel tuo acquisto</h4>
    <ul class="space-y-2">
      {% for feature in features %}
      <li class="flex items-start gap-2">
        <svg class="w-5 h-5 text-black shrink-0 mt-0.5" fill="currentColor" viewBox="0 0 20 20">
          <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/>
        </svg>
        <span class="text-sm text-black">{{ feature }}</span>
      </li>
      {% endfor %}
    </ul>
  </div>
  {% endif %}

  {# Sezione Secondaria (Lifetime) #}
  {% if secondaryTitle %}
  <div class="border-t-2 border-black pt-4">
    <h4 class="font-bold text-black mb-2">{{ secondaryTitle }}</h4>
    {% if secondarySubtitle %}
    <p class="text-sm text-gray-700 mb-3 italic">{{ secondarySubtitle }}</p>
    {% endif %}
    {% if secondaryFeatures.length > 0 %}
    <ul class="space-y-2">
      {% for feature in secondaryFeatures %}
      <li class="flex items-start gap-2">
        <svg class="w-5 h-5 text-black shrink-0 mt-0.5" fill="currentColor" viewBox="0 0 20 20">
          <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/>
        </svg>
        <span class="text-sm text-black">{{ feature }}</span>
      </li>
      {% endfor %}
    </ul>
    {% endif %}
  </div>
  {% endif %}
</aside>
{% endmacro %}

{# === MOBILE FEATURES (visibile solo su mobile, sopra il contenuto) === #}
{% macro sidebarMobileFeatures(
  tagline="",
  features=[],
  secondaryTitle="",
  secondarySubtitle="",
  secondaryFeatures=[]
) %}
<div class="border-2 border-black bg-white p-4 rounded-default shadow">
  {# Tagline in corsivo #}
  {% if tagline %}
  <p class="text-sm text-gray-700 italic mb-4">{{ tagline }}</p>
  {% endif %}

  {# Sezione Features Incluse #}
  {% if features.length > 0 %}
  <div class="mb-4">
    <h4 class="font-bold text-black mb-3 border-b-2 border-black pb-2">Incluso nel tuo acquisto</h4>
    <ul class="space-y-2">
      {% for feature in features %}
      <li class="flex items-start gap-2">
        <svg class="w-5 h-5 text-black shrink-0 mt-0.5" fill="currentColor" viewBox="0 0 20 20">
          <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/>
        </svg>
        <span class="text-sm text-black">{{ feature }}</span>
      </li>
      {% endfor %}
    </ul>
  </div>
  {% endif %}

  {# Sezione Secondaria (Lifetime) #}
  {% if secondaryTitle %}
  <div class="border-t-2 border-black pt-4">
    <h4 class="font-bold text-black mb-2">{{ secondaryTitle }}</h4>
    {% if secondarySubtitle %}
    <p class="text-sm text-gray-700 mb-3 italic">{{ secondarySubtitle }}</p>
    {% endif %}
    {% if secondaryFeatures.length > 0 %}
    <ul class="space-y-2">
      {% for feature in secondaryFeatures %}
      <li class="flex items-start gap-2">
        <svg class="w-5 h-5 text-black shrink-0 mt-0.5" fill="currentColor" viewBox="0 0 20 20">
          <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/>
        </svg>
        <span class="text-sm text-black">{{ feature }}</span>
      </li>
      {% endfor %}
    </ul>
    {% endif %}
  </div>
  {% endif %}
</div>
{% endmacro %}

{# === MOBILE CTA FIXED (visibile solo su mobile, fixed in basso) === #}
{% macro sidebarMobileCta(
  price,
  ctaText="Acquista subito!",
  ctaUrl,
  paymentNote="",
  urgencyNote=""
) %}
<div class="lg:hidden fixed bottom-0 left-0 right-0 z-50 border-t-2 border-black bg-white p-4">
  <div class="max-w-lg mx-auto">
    {# Nota urgenza compatta #}
    {% if urgencyNote %}
    <p class="text-sm text-black mb-2 text-center">
      <strong>Attenzione:</strong> {{ urgencyNote }}
    </p>
    {% endif %}

    <div class="flex items-center gap-4">
      {# Prezzo #}
      <div class="shrink-0">
        <span class="text-4xl font-bold text-black">{{ price }}</span>
        {% if paymentNote %}
        <p class="text-xs text-gray-600">{{ paymentNote }}</p>
        {% endif %}
      </div>

      {# Pulsante CTA #}
      <div class="flex-1">
        {{ button(ctaText, ctaUrl, className="w-full text-center justify-center") }}
      </div>
    </div>
  </div>
</div>
{# Spacer per evitare che il contenuto sia coperto dal CTA fixed #}
<div class="lg:hidden h-28"></div>
{% endmacro %}
